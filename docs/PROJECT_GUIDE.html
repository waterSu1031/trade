<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trade System - 프로젝트 가이드</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({ startOnLoad: true });</script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 0;
            margin-bottom: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        header h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header p {
            text-align: center;
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        nav {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: sticky;
            top: 20px;
            z-index: 100;
        }
        
        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        
        nav a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        nav a:hover {
            color: #764ba2;
        }
        
        .section {
            background: white;
            padding: 40px;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2em;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        h3 {
            color: #764ba2;
            margin: 20px 0 15px 0;
            font-size: 1.5em;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .feature-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .tech-badge {
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #667eea;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }
        
        .diagram-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .mermaid {
            text-align: center;
        }
        
        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            background: #f0f4ff;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s;
            margin: 10px 5px;
        }
        
        .btn:hover {
            background: #764ba2;
        }
        
        .icon {
            font-size: 1.2em;
            margin-right: 5px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .section {
                padding: 20px;
            }
            
            nav ul {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>🚀 Trade System</h1>
            <p>개인 자동화 트레이딩 시스템 - 프로젝트 가이드</p>
        </div>
    </header>

    <div class="container">
        <nav>
            <ul>
                <li><a href="#overview">개요</a></li>
                <li><a href="#architecture">아키텍처</a></li>
                <li><a href="#services">서비스 구성</a></li>
                <li><a href="#tech-stack">기술 스택</a></li>
                <li><a href="#deployment">배포</a></li>
                <li><a href="#monitoring">모니터링</a></li>
                <li><a href="#quick-start">빠른 시작</a></li>
            </ul>
        </nav>

        <section id="overview" class="section">
            <h2>📋 프로젝트 개요</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>🎯 MSA 아키텍처</h4>
                    <p>마이크로서비스 기반의 확장 가능한 설계로 각 서비스가 독립적으로 배포 및 확장 가능</p>
                </div>
                <div class="feature-card">
                    <h4>🤖 자동화 트레이딩</h4>
                    <p>Interactive Brokers API를 통한 실시간 시장 데이터 수신 및 자동 주문 실행</p>
                </div>
                <div class="feature-card">
                    <h4>📊 실시간 모니터링</h4>
                    <p>Grafana 대시보드를 통한 시스템 메트릭, 트레이딩 성과 실시간 모니터링</p>
                </div>
                <div class="feature-card">
                    <h4>🔄 CI/CD 파이프라인</h4>
                    <p>GitHub Actions를 활용한 자동화된 빌드, 테스트, 배포 프로세스</p>
                </div>
            </div>

            <div class="alert">
                <strong>💡 핵심 목표:</strong> 개인 투자자를 위한 전문가 수준의 트레이딩 시스템을 제공하여 
                안정적이고 효율적인 자동화 트레이딩 환경을 구축합니다.
            </div>
        </section>

        <section id="architecture" class="section">
            <h2>🏗️ 시스템 아키텍처</h2>
            
            <div class="diagram-container">
                <div class="mermaid">
                    graph TB
                        subgraph "External Services"
                            IB[IB Gateway<br/>Port: 4002]
                            GH[GitHub]
                            DH[Docker Hub]
                        end
                        
                        subgraph "Frontend Layer"
                            UI[SvelteKit App<br/>Port: 3000]
                        end
                        
                        subgraph "Backend Services"
                            API[FastAPI Backend<br/>Port: 8000]
                            BATCH[Spring Boot Batch<br/>Port: 8080]
                            ENGINE[Python Engine<br/>Port: 8001]
                        end
                        
                        subgraph "Data Layer"
                            PG[(PostgreSQL<br/>Port: 5432)]
                            REDIS[(Redis<br/>Port: 6379)]
                        end
                        
                        subgraph "Infrastructure"
                            NGINX[Nginx<br/>Port: 80/443]
                            DOCKER[Docker Compose]
                        end
                        
                        UI --> NGINX
                        NGINX --> API
                        API --> PG
                        API --> REDIS
                        API --> IB
                        BATCH --> PG
                        BATCH --> IB
                        ENGINE --> PG
                        ENGINE --> IB
                </div>
            </div>

            <h3>주요 구성요소</h3>
            <ul>
                <li><strong>Frontend:</strong> SvelteKit 기반의 반응형 웹 인터페이스</li>
                <li><strong>Backend:</strong> FastAPI와 Spring Boot를 활용한 마이크로서비스</li>
                <li><strong>Database:</strong> PostgreSQL (주 데이터베이스) + Redis (캐싱)</li>
                <li><strong>Infrastructure:</strong> Docker Compose 기반 컨테이너 오케스트레이션</li>
            </ul>
        </section>

        <section id="services" class="section">
            <h2>🔧 마이크로서비스 구성</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>서비스명</th>
                        <th>기술 스택</th>
                        <th>주요 기능</th>
                        <th>포트</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>trade_frontend</strong></td>
                        <td>TypeScript, SvelteKit</td>
                        <td>웹 UI, 실시간 차트, 대시보드</td>
                        <td>3000</td>
                    </tr>
                    <tr>
                        <td><strong>trade_dashboard</strong></td>
                        <td>Python, FastAPI</td>
                        <td>REST API, WebSocket, 데이터 관리</td>
                        <td>8000</td>
                    </tr>
                    <tr>
                        <td><strong>trade_engine</strong></td>
                        <td>Python</td>
                        <td>트레이딩 전략 실행, 신호 생성</td>
                        <td>8001</td>
                    </tr>
                    <tr>
                        <td><strong>trade_batch</strong></td>
                        <td>Java, Spring Boot</td>
                        <td>배치 작업, 스케줄링, 헬스체크</td>
                        <td>8080</td>
                    </tr>
                </tbody>
            </table>

            <h3>데이터 흐름</h3>
            <div class="diagram-container">
                <div class="mermaid">
                    sequenceDiagram
                        participant User
                        participant Frontend
                        participant API
                        participant Engine
                        participant IBKR
                        participant DB
                        
                        User->>Frontend: 전략 설정
                        Frontend->>API: REST API 요청
                        API->>DB: 설정 저장
                        API->>Engine: 전략 실행 요청
                        Engine->>IBKR: 시장 데이터 요청
                        IBKR-->>Engine: 실시간 데이터
                        Engine->>Engine: 신호 생성
                        Engine->>IBKR: 주문 실행
                        Engine->>DB: 거래 기록
                        API-->>Frontend: WebSocket 업데이트
                        Frontend-->>User: 실시간 상태
                </div>
            </div>
        </section>

        <section id="tech-stack" class="section">
            <h2>💻 기술 스택</h2>
            
            <h3>Frontend</h3>
            <div class="tech-stack">
                <span class="tech-badge">SvelteKit</span>
                <span class="tech-badge">TypeScript</span>
                <span class="tech-badge">TailwindCSS</span>
                <span class="tech-badge">Chart.js</span>
                <span class="tech-badge">WebSocket</span>
            </div>

            <h3>Backend</h3>
            <div class="tech-stack">
                <span class="tech-badge">Python 3.11</span>
                <span class="tech-badge">FastAPI</span>
                <span class="tech-badge">Java 17</span>
                <span class="tech-badge">Spring Boot</span>
                <span class="tech-badge">SQLAlchemy</span>
                <span class="tech-badge">JPA</span>
            </div>

            <h3>Database</h3>
            <div class="tech-stack">
                <span class="tech-badge">PostgreSQL 15</span>
                <span class="tech-badge">Redis 7</span>
                <span class="tech-badge">SQLite</span>
            </div>

            <h3>Infrastructure</h3>
            <div class="tech-stack">
                <span class="tech-badge">Docker</span>
                <span class="tech-badge">Docker Compose</span>
                <span class="tech-badge">Nginx</span>
                <span class="tech-badge">GitHub Actions</span>
            </div>

            <h3>Monitoring</h3>
            <div class="tech-stack">
                <span class="tech-badge">Prometheus</span>
                <span class="tech-badge">Grafana</span>
                <span class="tech-badge">Loki</span>
                <span class="tech-badge">Promtail</span>
            </div>

            <h3>Trading</h3>
            <div class="tech-stack">
                <span class="tech-badge">Interactive Brokers API</span>
                <span class="tech-badge">ib-insync</span>
                <span class="tech-badge">vectorbtpro</span>
                <span class="tech-badge">TA-Lib</span>
            </div>
        </section>

        <section id="deployment" class="section">
            <h2>🚀 배포 구조</h2>
            
            <h3>Docker Compose 환경</h3>
            <table>
                <thead>
                    <tr>
                        <th>파일명</th>
                        <th>용도</th>
                        <th>포함 서비스</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>docker-compose.yml</code></td>
                        <td>기본 운영 환경</td>
                        <td>DB, Redis, Backend, Frontend, Nginx</td>
                    </tr>
                    <tr>
                        <td><code>docker-compose.dev.yml</code></td>
                        <td>개발 환경</td>
                        <td>핫 리로드, 디버그 포트 활성화</td>
                    </tr>
                    <tr>
                        <td><code>docker-compose.full.yml</code></td>
                        <td>전체 스택</td>
                        <td>모니터링 스택 포함 (PLG Stack)</td>
                    </tr>
                </tbody>
            </table>

            <h3>배포 명령어</h3>
            <div class="code-block">
# 개발 환경 시작
cd trade_infra/docker/compose
docker-compose -f docker-compose.dev.yml up -d

# 운영 환경 시작
docker-compose up -d

# 전체 스택 시작 (모니터링 포함)
docker-compose -f docker-compose.full.yml up -d

# 서비스 상태 확인
docker-compose ps

# 로그 확인
docker-compose logs -f [service_name]
            </div>
        </section>

        <section id="monitoring" class="section">
            <h2>📊 모니터링 시스템</h2>
            
            <h3>PLG Stack (Prometheus + Loki + Grafana)</h3>
            <div class="diagram-container">
                <div class="mermaid">
                    graph LR
                        subgraph "Applications"
                            A1[trade_frontend]
                            A2[trade_dashboard]
                            A3[trade_engine]
                            A4[trade_batch]
                        end
                        
                        subgraph "Metrics"
                            PROM[Prometheus<br/>:9090]
                            NE[Node Exporter]
                            PE[Postgres Exporter]
                            RE[Redis Exporter]
                        end
                        
                        subgraph "Logs"
                            LOKI[Loki<br/>:3100]
                            PROMTAIL[Promtail]
                        end
                        
                        subgraph "Visualization"
                            GRAFANA[Grafana<br/>:3001]
                        end
                        
                        A1 --> PROM
                        A2 --> PROM
                        A3 --> PROM
                        A4 --> PROM
                        
                        A1 -.-> PROMTAIL
                        A2 -.-> PROMTAIL
                        A3 -.-> PROMTAIL
                        A4 -.-> PROMTAIL
                        
                        PROMTAIL --> LOKI
                        PROM --> GRAFANA
                        LOKI --> GRAFANA
                </div>
            </div>

            <h3>대시보드 접속</h3>
            <ul>
                <li><strong>Grafana:</strong> <a href="http://localhost:3001" target="_blank">http://localhost:3001</a> (freeksj / [REDACTED])</li>
                <li><strong>Prometheus:</strong> <a href="http://localhost:9090" target="_blank">http://localhost:9090</a></li>
                <li><strong>Loki:</strong> Grafana를 통해 접근</li>
            </ul>
        </section>

        <section id="quick-start" class="section">
            <h2>⚡ 빠른 시작 가이드</h2>
            
            <h3>1. 환경 설정</h3>
            <div class="code-block">
# 저장소 클론
git clone https://github.com/your-username/trade.git
cd trade

# 환경변수 설정
cp .env.example .env.development
# .env.development 파일 편집하여 필요한 값 설정
            </div>

            <h3>2. Docker 컨테이너 시작</h3>
            <div class="code-block">
# 개발 환경으로 시작
cd trade_infra/docker/compose
docker-compose -f docker-compose.dev.yml up -d

# 상태 확인
docker-compose ps
            </div>

            <h3>3. 서비스 접속</h3>
            <ul>
                <li><strong>Frontend:</strong> <a href="http://localhost:3000" target="_blank">http://localhost:3000</a></li>
                <li><strong>API 문서:</strong> <a href="http://localhost:8000/docs" target="_blank">http://localhost:8000/docs</a></li>
                <li><strong>Grafana:</strong> <a href="http://localhost:3001" target="_blank">http://localhost:3001</a></li>
            </ul>

            <h3>4. 테스트 실행</h3>
            <div class="code-block">
# Docker 서비스 테스트
./trade_infra/docker/scripts/test-docker.sh

# 개별 서비스 테스트
docker-compose exec backend pytest
docker-compose exec batch ./mvnw test
            </div>

            <div class="alert">
                <strong>📌 중요:</strong> Interactive Brokers 계정과 IB Gateway/TWS가 실행 중이어야 트레이딩 기능이 작동합니다.
                Paper Trading은 포트 4002, Live Trading은 포트 4001을 사용합니다.
            </div>

            <div style="text-align: center; margin-top: 40px;">
                <a href="https://github.com/your-username/trade" class="btn">
                    <span class="icon">📦</span> GitHub 저장소
                </a>
                <a href="/docs/OPERATIONS.md" class="btn">
                    <span class="icon">📖</span> 운영 가이드
                </a>
                <a href="/docs/ACCOUNTS_AND_ACCESS.md" class="btn">
                    <span class="icon">🔑</span> 계정 정보
                </a>
            </div>
        </section>
    </div>

    <footer style="background: #333; color: white; text-align: center; padding: 20px; margin-top: 40px;">
        <p>&copy; 2024 Trade System. All rights reserved.</p>
    </footer>
</body>
</html>